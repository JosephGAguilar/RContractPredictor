# Baseball Contract Predictor in R

## Introduction 
It is currently the off season for Major League Baseball, and the off season begets signings of players who are free agents. A big part of the job for general managers of teams interested in signing players is deciding a fair contract for the players they are signing. I would like to see if there is any statistically-driven way to help create these contracts and decide on an average annual value (AAV) for the player. Of course, I anticipate that numbers generated by this statistically analysis would only act as a starting point for negotiations, as contracts can also be influenced by non-statistic factors (endorsements, marketability, home town discount, etc.). Shohei Ohtani, for example, signed a 700 million dollar deal with the Los Angeles Dodgers. From his stats, that may be seen as a massive overpay (even for his immense talent and skill), but his jersey sales and his global popularity as a Japanese two-way (hitting AND pitching) player more than make up for it. In short, the problem I am addressing is if there is a way to statistically decide fair contracts for players AND teams. If there is, it would be an immensely useful tool for agents of players and general managers alike.

I will be taking in the stats and salaries of position players (NOT pitchers) across the 2002-2016 seasons from the Sean Lahman Baseball Database, using the "Lahman" R Package. (https://cran.r-project.org/web/packages/Lahman/Lahman.pdf)  Given that these are not modern seasons, this will also serve as a study of how baseball contract prices have changed as of recent. Modern baseball contracts are far more expensive than contracts of the past. I am not currently using this data in another class or for another research project.

There have been similar analyses done (https://ajaypatell8.medium.com/modeling-free-agent-contracts-in-mlb-4fada2220add), especially with the rise of Google's Statcast tool to help analyse statistics across full baseball seasons. There is a very popular book (and movie) called *Moneyball* detailing the story of the 2002 Oakland Athletics and how their use of statistics allowed them to compile a very cheap and talented team that would go on a famous 20-game win streak. This "moneyball" strategy took off, and I imagine many major league teams have similar tools for acquiring underrated players on team-friendly deals. This project will mainly be focused on discovering how these teams perform this analysis.

### Creating a Data Frame of Relevant and Useful Statistics
The original batting data created a separate case for each year that a player played for, as well as a separate case for each team that the player played for during that year. This clouded our statistical analysis, since even though a single player should be treated as a single case with their single salary, those players became multiple different cases with the same salary but different stats. If a player was signed to an expensive long-term contract, and then they got traded to a different for a few months of a season and only put up a relatively low number of at-bats, this player's salary would be attached to a pitiful stat line and treated similarly to their all-star numbers that earned them their high salary in the first place. In short, I grouped all of the stats by player ID, and summed up their stats to generate career stats and career money earned from 2002 - 2016 (the "Moneyball" era of baseball). 

I then attached these stats to a different dataset that contained information on a player's WAR (wins above replacement), a statistic that takes in a multitude of nuanced league-wide factors and tells us how many wins that the player contributed to that a similar player would not have. I attached this combined data set to another data set containing the salaries of players throughout their careers. This helped with a more straightforward statistical analysis. 

I also created functions to generate more nuanced offensive metrics from their stats, like on-base percentage (OBP), slugging percentage (SLG), and on-base plus slugging (OPS).

### Different Statistics Plotted Against Player Salary
<img width="719" alt="Screen Shot 2025-01-15 at 10 33 47 PM" src="https://github.com/user-attachments/assets/8b23f17a-9056-43a2-8a64-3bbdc5a5a650" />
<img width="705" alt="Screen Shot 2025-01-15 at 10 34 00 PM" src="https://github.com/user-attachments/assets/2d629954-4030-4ce2-8bb3-24f322517305" />
<img width="708" alt="Screen Shot 2025-01-15 at 10 34 10 PM" src="https://github.com/user-attachments/assets/1ce61848-d2a2-4f6c-a88c-933c0cf89090" />

The first box plot of a player's salary against where they fall on a WAR percentile scale gives us the clearest indication that there is a statistical correlation between offensive production and total salary. While this seems obvious, the box plot showing that obvious of a trend is positive indication that we can help predict salaries through statistical analysis. Players that fall in the highest WAR percentile have the highest average salaries, while players that fall into the lower half of league WAR make the least amount of money.

The other plots also show how salaries correlate with runs batted in and home runs. There seems to be a clear positive linear trend with RBIs, and a little more subtle positive linear trend with home runs. RBIs are an important metric, runs will win baseball games and a player that drives in more of them will be more sought after. This also shows us that more straightforward stats like RBIs can also contribute to our investigation.

### Analyses: Linear Regression Model Test, and Polynomial Regression Model Evaluation
Based on Juan Soto's stats last year, he should make 371,837,141 USD over 15 years.
Based on Shohei Ohtani's stats last year, he should make 304,827,643 USD over 10 years.
Based on Fernando Tatis Jr.'s stats before his extension, he should have made 363,811,783 USD over 14 years.
Based on Jurickson Profar's stats last year, he should have made 5,022,416 USD.
Based on Jurickson Profar's stats last year, he should make 24,425,490 USD over 3 years.
Based on Jackson Merrill's stats last year, the Padres should extend him for 336,407,958 USD over 14 years.

Before discussing the linear model's results, I will discuss how it was developed. I included seven variables for the model's consideration, which resulted in an $R^2$ value of 0.86, meaning 86% of contract variability could be explained through these seven variables. The first and most obvious variables I chose were WAR, RBIs, and home runs, as those were the variables that I saw bad the most obvious correlation with salary. In addition, I included batting average (BA), OBP, and OPS, as these are regarded as important metrics in the baseball world for discussing a player's offensive output. The correlation between these stats and player salaries was less obvious from my findings but I still included them to see if they actually are impactful when discussing salary. Finally, I included the length of a contract/signing in years as an interaction factor between WAR, RBIs, and HRs. These variables will often depend on how long a player has been playing, since you will accrue more WAR, RBI, and HR as your career continues. I would like my model to take that into consideration.

I tried to find if a polynomial regression model would fit my data better. I tested this by trying different degree polynomials and used adjusted $R^2$ values, AIC, BIC, and cross-validation to determine which degree polynomial fit my model and data the best. Seeing which each degree polynomial each test output and taking the median best degree, I found that a 2nd degree polynomial was the best fit for my model.

As for applying my model, let's go to Juan Soto's 15 year 765 million dollar contract. If Soto were to maintain his all-star stat line last year over the course of those 15 years, the model predicts that he would only be worth about 371 million dollars. This is nearly half of what he is actually making. Initial reactions to this deal have deemed it a massive overpay, and my model seems to agree.

Going to the previous most expensive contract in sports history, Shohei Ohtani is currently in a 10 year 700 million dollar contract. If Ohtani were to maintain his all-star stat line last year over the course of those 10 years, the model predicts that the contract would only be worth about 300 million dollars. This is, again, nearly half of what he is actually making. However, there are actually outside factors that make this a lot less of an overpay than it may seem. Ohtani is the only two-way player in the league, meaning he both hits AND pitches. The Dodgers are not only paying for a hitter, but also for a star pitcher. In addition, Ohtani is one of the few Japanese players in the league, and so he generates a lot of endorsements and ad-revenue from Japan. The Dodgers felt that 700 million dollars would be covered by Ohtani's endorsements, as well as be worth the cost of paying for both an MVP hitter and an ace pitcher. I am inclined to agree.

Let's move to a contract that is deemed a very cheap and team-friendly, Fernando Tatis Jr.'s 14 year 340 million dollar deal. Based on the stats from 2021 that Tatis Jr. was signed for, the model predicts that over 14 years, he would make 363 million dollars. This is about 23 million dollars over what he is actually making. Many analysts have called this deal very agreeable and friendly for both the San Diego Padres and Tatis Jr., and my model and I agree.

I've also wondered if players can make less than what they're actually worth. I fed Jurickson Profar's breakout season last year into the model, as Profar's burst of power seemed to appear out of nowhere to most sports analysts. The San Diego Padres signed Profar to a 1 year, 1 million dollar deal to be a backup outfielder. However, Profar had an all-star season and became their starting outfielder and leadoff hitter. Putting his breakout stats into the model, it seemed that he actually deserved 5 million dollars this past year. The Padres saved about 4 million dollars on an allstar outfielder. Going forward, the model predicts that a 3-year contract (which is what analysts believe he is getting) for Profar would go for about 24 million dollars.

This model would also be useful in negotiations for rookies looking to have their contract extended by their teams. I took Jackson Merrill's all-star rookie season with the San Diego Padres last year to see how much his rookie season could earn him. Fernando Tatis Jr. had a similar all-star rookie season, which earned him a 14-year contract extension. I asked the model to predict how much money Jackson Merrill could earn in the future if he were to keep up his rookie stat line for 14 years, and the model predicted that he is worth about 340 million dollars (about the same as Tatis!). The San Diego Padres may consider signing him now to prevent him from becoming even more expensive in the future, or wait to see if he can continue this same level of offensive production. 


## Conclusion 
After using the model to predict current-day contracts, I found that contract prices have indeed skyrocketed in recent years. This was obvious from my observations. The most expensive contract from the "Moneyball" era (2002-2016) that my data is looking at was a 10-year 252 million dollar contract signed by Alex Rodriguez. The most expensive contract as of 2024 is Juan Soto's 765 million dollar contract with the Mets. From my testing, I found that my model, when used to predict current day contracts, would predict almost 1/2 of the actual value of their contract. For example, Fernando Tatis Jr. signed a 14-year 340 million dollar contract in 2021. When I input Tatis Jr.'s stats from 2021 into the model to predict a 14 year contract, it estimated about 180 million dollars, which is nearly half of his actual earnings over 14 years. So, a rule of thumb I found was to multiply my model's output by 2 when trying to predict modern-day contracts. It's interesting to see that modern baseball contracts have doubled in the last 8 years.

From my research, it does seem very possible to generate reasonable and realistic contracts purely from offensive baseball stat lines, which is was the problem I was seeking to address. A possible shortcoming of my project is that which teams were doing the signings was not considered in the contract process. Certain teams, like the Dodgers, Yankees, and Mets, are able to spend a lot more money than teams like the Athletic's or the Guardians. I would be curious to see if the teams interested in a player would have any impact on how much money they are projected to earn. Overall, I am satistified with my findings and will be curious to see how my model will stack up with reality as the off season continues.
